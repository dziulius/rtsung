require 'rtsung'

RTsung::XML.new do
  clients do
    host 'localhost', { :use_controller_vm => true, :cpu => 2 } do
      ip '192.168.1.2'
    end
  end

  servers do
    host 'example.com'
    host 'www.example.com', :port => 8080
  end

  load do
    # first arrival phase (one minute, new user every five seconds)
    phase 1, :interval, 5, :second

    # second arrival phase (ten minutes, two users per second)
    phase 2, :rate, 2, 'second', { :duration => 10, :unit => 'minute' }
  end

  options do
    option :user_agent do
      user_agent 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.7.8) Gecko/20050513 Galeon/1.3.21', :probability => 50
      user_agent 'Mozilla/5.0 (Windows; U; Windows NT 5.2; fr-FR; rv:1.7.8) Gecko/20050511 Firefox/1.0.4', :probability => 50
    end
  end

  sessions do
    session 'users' do
      think 1..5
    end
  end
end
